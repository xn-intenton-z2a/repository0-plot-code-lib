# CALC_ENGINE

## Overview
The CALC_ENGINE feature introduces a suite of numerical analysis and data transformation tools to complement the plotting capabilities of the repository. In addition to performing derivative calculations, area under curve estimation, and statistical computations, this updated module now provides geometric and data transformation functionalities such as rotation, reflection, scaling, inversion, and smoothing (moving average). This enhancement allows users to preprocess or post-process plot data for improved visual interpretation and deeper mathematical insights.

## Key Objectives
- **Numerical Analysis Integration:** Seamlessly integrate with the PLOT_ENGINE to process and analyze computed plot data for enhanced diagnostics and mathematical evaluation.
- **Derivative Calculation:** Implement methods to approximate the derivative of a given function using finite differences.
- **Area Estimation:** Calculate the area under a curve using the trapezoidal rule for quick quantification of aggregate properties.
- **Statistical Computation:** Provide functionalities to compute average, median, mode, and standard deviation from plot-generated data arrays.
- **Data Transformations:** Introduce transformation routines including rotation, reflection, scaling, inversion, and smoothing. These functions allow users to modify data sets both before and after analysis, aligning with extended visualization capabilities and innovative data manipulation techniques.
- **CLI and Library Interface:** Support distinct CLI flags (e.g., `--analyze` for numerical analysis and `--transform` for data transformations) and enable programmatic access via ES modules for use in external scripts.

## Design & Implementation
### Architecture
- **Modular Design:** All analysis and transformation routines are consolidated into a single source file (e.g., `calcEngine.js`), ensuring minimal dependencies and ease of testing and future extensions.
- **Interdependency with PLOT_ENGINE:** The CALC_ENGINE operates on data generated by the PLOT_ENGINE. It validates input early and provides detailed diagnostic feedback along with transformed data outputs.

### CLI and API Integration
- **CLI Flags:**
  - `--analyze`: Triggers numerical analysis functions such as derivative approximation, area calculation, and basic statistical computations.
  - `--transform`: Activates transformation routines. Users can specify transformation parameters (e.g., `rotate=90`) to apply geometric or smoothing operations.
- **Error Handling:** Leverage robust input validation similar to PLOT_ENGINE to ensure clear, actionable error messages for both analysis and transformation processes.
- **Output Format:** Analysis and transformation results are returned in JSON format, supporting smooth pipeline integration and further programmatic processing.

### Testing & Documentation
- **Unit Tests:** Extend the vitest suite (e.g., in `tests/unit/calcEngine.test.js`) to cover both numerical analysis and data transformation functionalities, ensuring accuracy over typical and edge case scenarios.
- **Documentation Updates:** Revise README and CONTRIBUTING guides to include usage examples covering both the `--analyze` and `--transform` functionalities.
- **Backward Compatibility:** Maintain existing CLI behavior for users relying solely on numerical analysis while providing an opt-in mechanism for data transformation features.

## Usage Examples
### Numerical Analysis
```bash
node src/lib/main.js output.svg "quad:1,0,0,-10,10,1" --analyze
```
### Data Transformation
```bash
node src/lib/main.js output.svg "quad:1,0,0,-10,10,1" --transform rotate=90
```

This update to the CALC_ENGINE ensures that the repository not only provides robust numerical analysis but also empowers users with flexible data manipulation capabilities in line with the repository's mission of being a go-to plot library for versatile mathematical visualizations.