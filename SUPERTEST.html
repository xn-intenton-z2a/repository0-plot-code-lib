<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>agentic-lib</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; background-color: #f9f9f9; color: #333; }
    header { padding-bottom: 1em; border-bottom: 2px solid #ccc; margin-bottom: 1em; }
    h1 { font-size: 2em; }
    section { margin-bottom: 1.5em; }
    ul { list-style: none; padding: 0; }
    li { margin: 0.5em 0; }
    .label { font-weight: bold; }
    footer { margin-top: 2em; font-size: 0.9em; color: #777; }
    a { color: #0366d6; text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <header>
    <h1>agentic-lib</h1>
    <p><a href="https://github.com/xn-intenton-z2a/agentic-lib">repository</a> - <a href="https://xn-intenton-z2a.github.io/agentic-lib/latest.html">latest stats</a> - <a href="https://xn-intenton-z2a.github.io/agentic-lib/all.html">all stats</a></p>
  </header>
  <section>
    <h1 class="md-github"><a class="md-github__anchor" name="supertest" href="#supertest"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SUPERTEST</h1>
<h2 class="md-github"><a class="md-github__anchor" name="crawl-summary" href="#crawl-summary"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Crawl Summary</h2>
<p class="md-github">SuperTest provides a fluent API built on superagent for making HTTP assertions. Key details include installation via npm, usage examples with express, support for HTTP2 via { http2:true } options, integration examples with mocha using callbacks, promises, and async/await, and built-in support for cookie persistence using request.agent. API methods include various forms of .expect() for status codes, headers, bodies, and custom assertions.</p>
<h2 class="md-github"><a class="md-github__anchor" name="normalised-extract" href="#normalised-extract"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Normalised Extract</h2>
<p class="md-github">Table of Contents:</p>
<ol class="md-github">
<li class="md-github">
<p class="md-github">Installation &amp; Setup</p>
</li>
<li class="md-github">
<p class="md-github">HTTP and HTTP2 Request Handling</p>
</li>
<li class="md-github">
<p class="md-github">API Methods and Assertions</p>
</li>
<li class="md-github">
<p class="md-github">Mocha, Promise, and Async Testing Patterns</p>
</li>
<li class="md-github">
<p class="md-github">Cookie Persistence with request.agent</p>
</li>
<li class="md-github">
<p class="md-github">Custom Assertions and Response Modification</p>
</li>
<li class="md-github">
<p class="md-github">Installation &amp; Setup:</p>
</li>
</ol>
<ul class="md-github">
<li class="md-github">Use npm install supertest --save-dev</li>
<li class="md-github">Import with require('supertest') in Node.js projects.</li>
</ul>
<ol start="2" class="md-github">
<li class="md-github">HTTP and HTTP2 Request Handling:</li>
</ol>
<ul class="md-github">
<li class="md-github">Basic usage: request(app).get('/user')</li>
<li class="md-github">For HTTP2, pass options: request(app, { http2: true }) or request.agent(app, { http2: true })</li>
</ul>
<ol start="3" class="md-github">
<li class="md-github">API Methods and Assertions:</li>
</ol>
<ul class="md-github">
<li class="md-github">.expect(status[, fn]) asserts the response status code.</li>
<li class="md-github">.expect(status, body[, fn]) asserts both status and response body.</li>
<li class="md-github">.expect(body[, fn]) asserts response body using string, regex or object.</li>
<li class="md-github">.expect(field, value[, fn]) asserts header field values.</li>
<li class="md-github">.expect(function(res){}) for custom assertions.</li>
<li class="md-github">.end(fn) finalizes the test and returns errors in callback.</li>
</ul>
<ol start="4" class="md-github">
<li class="md-github">Mocha, Promise, and Async Testing Patterns:</li>
</ol>
<ul class="md-github">
<li class="md-github">Callback style: pass done to .expect(200, done)</li>
<li class="md-github">Promise style: return request(...).then(response =&gt; { ... })</li>
<li class="md-github">Async/await: const response = await request(...); then validate headers and body.</li>
</ul>
<ol start="5" class="md-github">
<li class="md-github">Cookie Persistence with request.agent:</li>
</ol>
<ul class="md-github">
<li class="md-github">Use request.agent(app) to persist cookies through subsequent requests.</li>
<li class="md-github">Example: agent.get('/').expect('set-cookie', 'cookie=hey; Path=/') then agent.get('/return') to validate cookie transmission.</li>
</ul>
<ol start="6" class="md-github">
<li class="md-github">Custom Assertions and Response Modification:</li>
</ol>
<ul class="md-github">
<li class="md-github">Modify response body within an .expect() function to set fixed IDs or adjust formats before final assertion.</li>
<li class="md-github">Example: res.body.id = 'some fixed id'; res.body.name = res.body.name.toLowerCase(); followed by .expect(200, {id:'some fixed id', name:'john'}, done).</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="supplementary-details" href="#supplementary-details"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Supplementary Details</h2>
<p class="md-github">Technical Specifications:</p>
<ul class="md-github">
<li class="md-github">HTTP2 Enablement: Pass { http2: true } as second parameter to request() or agent().</li>
<li class="md-github">Assertion Method Signatures:
expect(status[, fn]) where status is a number and fn is a callback function.
expect(status, body[, fn]) where body is an exact object or string for matching.
expect(body[, fn]) where body can be a string/regex/object.
expect(field, value[, fn]) to match header fields.</li>
<li class="md-github">Error handling: In .end(fn) callback, if error present, call done(err) to fail tests.</li>
<li class="md-github">Configuration Options:
Default port binding: uses ephemeral port if server not listening.
Cookie persistence via agent: maintains cookies across requests.
Superagent methods available: .write(), .pipe(), etc, for lower-level HTTP operations.</li>
<li class="md-github">Implementation Steps:
<ol class="md-github">
<li class="md-github">Install supertest using npm.</li>
<li class="md-github">Create express application endpoints.</li>
<li class="md-github">Use request(app) for testing endpoints.</li>
<li class="md-github">Apply .expect() assertions in sequence.</li>
<li class="md-github">Use .end(fn) to complete request and handle errors.</li>
<li class="md-github">For asynchronous tests, use promise return or async/await.</li>
<li class="md-github">For HTTP2 testing, include { http2:true } option.</li>
</ol>
</li>
<li class="md-github">Best Practices:
<ul class="md-github">
<li class="md-github">Ensure correct Content-Type and Content-Length headers are asserted when testing JSON responses.</li>
<li class="md-github">Use agent for stateful tests like cookie persistence.</li>
<li class="md-github">Order .expect() calls to systematically modify the response if needed before final assertion.</li>
</ul>
</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="reference-details" href="#reference-details"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reference Details</h2>
<p class="md-github">API Specifications:</p>
<p class="md-github">Method: request(app | url, [options]) -&gt; Returns a SuperTest instance.
Options: { http2: boolean }</p>
<p class="md-github">Method: .get(path: string) -&gt; SuperTest instance; path is the endpoint string.
Method: .post(path: string) -&gt; SuperTest instance.
Method: .send(data: object|string) -&gt; SuperTest instance; data type based on content-type.
Method: .set(field: string, value: string|RegExp) -&gt; SuperTest instance.
Method: .auth(username: string, password: string) -&gt; SuperTest instance.
Method: .expect(status: number, [callback: (err: Error, res: Response) =&gt; void])
Method: .expect(status: number, body: any, [callback])
Method: .expect(body: string|RegExp|object, [callback])
Method: .expect(field: string, value: string|RegExp, [callback])
Method: .expect(fn: (res: Response) =&gt; void) -&gt; Custom assertion that throws error if fails.
Method: .end(callback: (err: Error, res: Response) =&gt; void)</p>
<p class="md-github">Full Code Example with Comments:
// Basic usage of SuperTest with Express
const request = require('supertest');
const express = require('express');</p>
<p class="md-github">// Create an Express app
const app = express();
app.get('/user', function(req, res) {
// Responds with JSON containing name 'john'
res.status(200).json({ name: 'john' });
});</p>
<p class="md-github">// Test the /user endpoint
request(app)
.get('/user') // HTTP GET request
.set('Accept', 'application/json') // Set request header
.expect('Content-Type', /json/) // Expect response Content-Type to match JSON pattern
.expect('Content-Length', '15') // Expect Content-Length to be '15'
.expect(200) // Assert HTTP status 200
.end(function(err, res) {
// Error handling; if error exists, throw it to fail test
if (err) throw err;
});</p>
<p class="md-github">// HTTP2 Enablement Example
request(app, { http2: true })
.get('/user')
.expect(200)
.end(function(err, res) {
if (err) throw err;
});</p>
<p class="md-github">// Troubleshooting Procedure:
// 1. If an assertion fails using .end(fn), verify the response headers and body manually by logging res.
// 2. Run the test using npm test and check console output for error details.
// 3. For cookie issues, ensure using request.agent() to persist cookies.
// 4. Check that the server is bound and listening on an ephemeral port if not pre-bound.</p>
<p class="md-github">Configuration Options:</p>
<ul class="md-github">
<li class="md-github">npm install command: npm install supertest --save-dev</li>
<li class="md-github">Options for HTTP2: { http2: true } enables HTTP2 protocol support.</li>
<li class="md-github">Default callback error: Errors are passed as first argument in .end() method; handle with if(err) { done(err) }.</li>
</ul>
<p class="md-github">Return Types:</p>
<ul class="md-github">
<li class="md-github">All request methods return a SuperTest instance for chaining.</li>
<li class="md-github">.end() returns a callback with (err: Error|null, res: Response object).</li>
</ul>
<p class="md-github">Exceptions:</p>
<ul class="md-github">
<li class="md-github">If non-2XX status returned without .expect() status, error passed to callback.</li>
<li class="md-github">Custom assertion functions must throw an Error on failure.</li>
</ul>
<p class="md-github">Best Practices:</p>
<ul class="md-github">
<li class="md-github">Chain .expect() calls in the desired order.</li>
<li class="md-github">Use agent() for tests requiring cookie state.</li>
<li class="md-github">Leverage async/await for clean asynchronous tests.</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="information-dense-extract" href="#information-dense-extract"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Information Dense Extract</h2>
<p class="md-github">Install: npm install supertest --save-dev; Import: require('supertest'); API: request(app|url, {http2:boolean}); Methods: .get(path:string), .post(path:string), .set(field:string,value:string|RegExp), .send(data:object|string), .auth(username, password); Assertions: .expect(status[,fn]), .expect(status,body[,fn]), .expect(body[,fn]), .expect(field,value[,fn]), .expect(fn); End: .end(callback(err,res)); HTTP2: use {http2:true}; Mocha usage: callback style, promise chain, async/await; Cookie Persistence: request.agent(app); Custom assertion: function(res){ if(!cond) throw Error } ; Troubleshoot: Check .end() errors, validate response headers/body; Code pattern: chain .expect() then .end();</p>
<h2 class="md-github"><a class="md-github__anchor" name="sanitised-extract" href="#sanitised-extract"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sanitised Extract</h2>
<p class="md-github">Table of Contents:</p>
<ol class="md-github">
<li class="md-github">
<p class="md-github">Installation &amp; Setup</p>
</li>
<li class="md-github">
<p class="md-github">HTTP and HTTP2 Request Handling</p>
</li>
<li class="md-github">
<p class="md-github">API Methods and Assertions</p>
</li>
<li class="md-github">
<p class="md-github">Mocha, Promise, and Async Testing Patterns</p>
</li>
<li class="md-github">
<p class="md-github">Cookie Persistence with request.agent</p>
</li>
<li class="md-github">
<p class="md-github">Custom Assertions and Response Modification</p>
</li>
<li class="md-github">
<p class="md-github">Installation &amp; Setup:</p>
</li>
</ol>
<ul class="md-github">
<li class="md-github">Use npm install supertest --save-dev</li>
<li class="md-github">Import with require('supertest') in Node.js projects.</li>
</ul>
<ol start="2" class="md-github">
<li class="md-github">HTTP and HTTP2 Request Handling:</li>
</ol>
<ul class="md-github">
<li class="md-github">Basic usage: request(app).get('/user')</li>
<li class="md-github">For HTTP2, pass options: request(app, { http2: true }) or request.agent(app, { http2: true })</li>
</ul>
<ol start="3" class="md-github">
<li class="md-github">API Methods and Assertions:</li>
</ol>
<ul class="md-github">
<li class="md-github">.expect(status[, fn]) asserts the response status code.</li>
<li class="md-github">.expect(status, body[, fn]) asserts both status and response body.</li>
<li class="md-github">.expect(body[, fn]) asserts response body using string, regex or object.</li>
<li class="md-github">.expect(field, value[, fn]) asserts header field values.</li>
<li class="md-github">.expect(function(res){}) for custom assertions.</li>
<li class="md-github">.end(fn) finalizes the test and returns errors in callback.</li>
</ul>
<ol start="4" class="md-github">
<li class="md-github">Mocha, Promise, and Async Testing Patterns:</li>
</ol>
<ul class="md-github">
<li class="md-github">Callback style: pass done to .expect(200, done)</li>
<li class="md-github">Promise style: return request(...).then(response =&gt; { ... })</li>
<li class="md-github">Async/await: const response = await request(...); then validate headers and body.</li>
</ul>
<ol start="5" class="md-github">
<li class="md-github">Cookie Persistence with request.agent:</li>
</ol>
<ul class="md-github">
<li class="md-github">Use request.agent(app) to persist cookies through subsequent requests.</li>
<li class="md-github">Example: agent.get('/').expect('set-cookie', 'cookie=hey; Path=/') then agent.get('/return') to validate cookie transmission.</li>
</ul>
<ol start="6" class="md-github">
<li class="md-github">Custom Assertions and Response Modification:</li>
</ol>
<ul class="md-github">
<li class="md-github">Modify response body within an .expect() function to set fixed IDs or adjust formats before final assertion.</li>
<li class="md-github">Example: res.body.id = 'some fixed id'; res.body.name = res.body.name.toLowerCase(); followed by .expect(200, {id:'some fixed id', name:'john'}, done).</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="original-source" href="#original-source"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Original Source</h2>
<p class="md-github">Supertest Documentation
https://github.com/visionmedia/supertest</p>
<h2 class="md-github"><a class="md-github__anchor" name="digest-of-supertest" href="#digest-of-supertest"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Digest of SUPERTEST</h2>
<h1 class="md-github"><a class="md-github__anchor" name="supertest-documentation-digest" href="#supertest-documentation-digest"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SuperTest Documentation Digest</h1>
<p class="md-github">Date Retrieved: 2023-10-11</p>
<h2 class="md-github"><a class="md-github__anchor" name="overview" href="#overview"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h2>
<p class="md-github">SuperTest is a high-level abstraction for testing HTTP servers via the superagent library. It allows the user to test HTTP endpoints with various methods and assertions including custom checks, cookie handling, and HTTP2 protocol support.</p>
<h2 class="md-github"><a class="md-github__anchor" name="installation" href="#installation"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<ul class="md-github">
<li class="md-github">Command: npm install supertest --save-dev</li>
<li class="md-github">Import: require('supertest')</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="usage-examples" href="#usage-examples"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Usage Examples</h2>
<h3 class="md-github"><a class="md-github__anchor" name="basic-http-test-setup" href="#basic-http-test-setup"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic HTTP Test Setup</h3>
<p class="md-github">const request = require('supertest');
const express = require('express');</p>
<p class="md-github">const app = express();
app.get('/user', function(req, res) {
res.status(200).json({ name: 'john' });
});</p>
<p class="md-github">request(app)
.get('/user')
.expect('Content-Type', /json/)
.expect('Content-Length', '15')
.expect(200)
.end(function(err, res) {
if (err) throw err;
});</p>
<h3 class="md-github"><a class="md-github__anchor" name="enabling-http2" href="#enabling-http2"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enabling HTTP2</h3>
<p class="md-github">const request = require('supertest');
const express = require('express');</p>
<p class="md-github">const app = express();
app.get('/user', function(req, res) {
res.status(200).json({ name: 'john' });
});</p>
<p class="md-github">request(app, { http2: true })
.get('/user')
.expect('Content-Type', /json/)
.expect('Content-Length', '15')
.expect(200)
.end(function(err, res) {
if (err) throw err;
});</p>
<p class="md-github">// Using agent for HTTP2
request.agent(app, { http2: true })
.get('/user')
.expect('Content-Type', /json/)
.expect('Content-Length', '15')
.expect(200)
.end(function(err, res) {
if (err) throw err;
});</p>
<h3 class="md-github"><a class="md-github__anchor" name="mocha-integration-and-async-testing" href="#mocha-integration-and-async-testing"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mocha Integration and Async Testing</h3>
<p class="md-github">describe('GET /user', function() {
it('responds with json', function(done) {
request(app)
.get('/user')
.set('Accept', 'application/json')
.expect('Content-Type', /json/)
.expect(200, done);
});
});</p>
<p class="md-github">describe('GET /users', function() {
it('responds with json using promises', function() {
return request(app)
.get('/users')
.set('Accept', 'application/json')
.expect('Content-Type', /json/)
.expect(200)
.then(response =&gt; {
expect(response.body.email).toEqual('foo@bar.com');
});
});
});</p>
<p class="md-github">describe('GET /users', function() {
it('responds with json using async/await', async function() {
const response = await request(app)
.get('/users')
.set('Accept', 'application/json');
expect(response.headers[&quot;Content-Type&quot;]).toMatch(/json/);
expect(response.status).toEqual(200);
expect(response.body.email).toEqual('foo@bar.com');
});
});</p>
<h3 class="md-github"><a class="md-github__anchor" name="custom-assertions-and-response-modification" href="#custom-assertions-and-response-modification"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Custom Assertions and Response Modification</h3>
<p class="md-github">describe('POST /user', function() {
it('user.name should be case-insensitive match for &quot;john&quot;', function(done) {
request(app)
.post('/user')
.send('name=john')
.set('Accept', 'application/json')
.expect(function(res) {
res.body.id = 'some fixed id';
res.body.name = res.body.name.toLowerCase();
})
.expect(200, {
id: 'some fixed id',
name: 'john'
}, done);
});
});</p>
<h3 class="md-github"><a class="md-github__anchor" name="cookie-persistence-example-using-agent" href="#cookie-persistence-example-using-agent"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cookie Persistence Example using agent</h3>
<p class="md-github">const request = require('supertest');
const express = require('express');
const cookieParser = require('cookie-parser');</p>
<p class="md-github">describe('request.agent(app)', function() {
const app = express();
app.use(cookieParser());</p>
<p class="md-github">app.get('/', function(req, res) {
res.cookie('cookie', 'hey');
res.send();
});</p>
<p class="md-github">app.get('/return', function(req, res) {
if (req.cookies.cookie) res.send(req.cookies.cookie);
else res.send(':(');
});</p>
<p class="md-github">const agent = request.agent(app);</p>
<p class="md-github">it('should save cookies', function(done) {
agent
.get('/')
.expect('set-cookie', 'cookie=hey; Path=/', done);
});</p>
<p class="md-github">it('should send cookies', function(done) {
agent
.get('/return')
.expect('hey', done);
});
});</p>
<h2 class="md-github"><a class="md-github__anchor" name="api-methods-overview" href="#api-methods-overview"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>API Methods Overview</h2>
<ul class="md-github">
<li class="md-github">.expect(status[, fn])</li>
<li class="md-github">.expect(status, body[, fn])</li>
<li class="md-github">.expect(body[, fn])</li>
<li class="md-github">.expect(field, value[, fn])</li>
<li class="md-github">.expect(function(res) { ... })</li>
<li class="md-github">.end(fn)</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="troubleshooting" href="#troubleshooting"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Troubleshooting</h2>
<ul class="md-github">
<li class="md-github">When .end() is used, failed assertions provide an error as a callback parameter; use if (err) return done(err); to handle errors.</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="attribution" href="#attribution"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Attribution</h2>
<p class="md-github">Crawled content data size: 589780 bytes, retrieved 4781 links.</p>
<h2 class="md-github"><a class="md-github__anchor" name="attribution-1" href="#attribution-1"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Attribution</h2>
<ul class="md-github">
<li class="md-github">Source: Supertest Documentation</li>
<li class="md-github">URL: https://github.com/visionmedia/supertest</li>
<li class="md-github">License: MIT License</li>
<li class="md-github">Crawl Date: 2025-04-27T01:08:23.412Z</li>
<li class="md-github">Data Size: 589780 bytes</li>
<li class="md-github">Links Found: 4781</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="retrieved" href="#retrieved"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Retrieved</h2>
<p class="md-github">2025-04-27</p>

  </section>
  <footer>
    <p>Generated on 2025-04-27T15:23:13.325Z</p>
  </footer>
</body>
</html>