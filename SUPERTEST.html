<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>agentic-lib</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; background-color: #f9f9f9; color: #333; }
    header { padding-bottom: 1em; border-bottom: 2px solid #ccc; margin-bottom: 1em; }
    h1 { font-size: 2em; }
    section { margin-bottom: 1.5em; }
    ul { list-style: none; padding: 0; }
    li { margin: 0.5em 0; }
    .label { font-weight: bold; }
    footer { margin-top: 2em; font-size: 0.9em; color: #777; }
    a { color: #0366d6; text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <header>
    <h1>agentic-lib</h1>
    <p><a href="https://github.com/xn-intenton-z2a/agentic-lib">repository</a> - <a href="https://xn-intenton-z2a.github.io/agentic-lib/latest.html">latest stats</a> - <a href="https://xn-intenton-z2a.github.io/agentic-lib/all.html">all stats</a></p>
  </header>
  <section>
    <h1 class="md-github"><a class="md-github__anchor" name="supertest" href="#supertest"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SUPERTEST</h1>
<h2 class="md-github"><a class="md-github__anchor" name="crawl-summary" href="#crawl-summary"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Crawl Summary</h2>
<p class="md-github">SuperTest is a Node.js library for HTTP assertions built on superagent. It allows testing of HTTP servers by wrapping an http.Server or function and binding to an ephemeral port if not listening. Key features include support for HTTP/2 via options, integration with testing frameworks like Mocha using callbacks, promises, or async/await, cookie persistence through request.agent, and custom assertion functions. API methods such as .expect(status[, fn]), .expect(body[, fn]), .auth(username, password), and .end(fn) provide versatile testing control. Detailed code examples are provided for basic usage, authentication, and multipart uploads.</p>
<h2 class="md-github"><a class="md-github__anchor" name="normalised-extract" href="#normalised-extract"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Normalised Extract</h2>
<p class="md-github">Table of Contents:</p>
<ol class="md-github">
<li class="md-github">
<p class="md-github">Introduction</p>
</li>
<li class="md-github">
<p class="md-github">Installation</p>
</li>
<li class="md-github">
<p class="md-github">Basic Usage</p>
</li>
<li class="md-github">
<p class="md-github">HTTP/2 Configuration</p>
</li>
<li class="md-github">
<p class="md-github">Testing Patterns</p>
</li>
<li class="md-github">
<p class="md-github">Authentication &amp; Cookie Handling</p>
</li>
<li class="md-github">
<p class="md-github">API Method Specifications</p>
</li>
<li class="md-github">
<p class="md-github">Introduction:</p>
</li>
</ol>
<ul class="md-github">
<li class="md-github">Library: SuperTest for testing HTTP servers using superagent.</li>
<li class="md-github">Supports ephemeral port binding if server not listening.</li>
</ul>
<ol start="2" class="md-github">
<li class="md-github">Installation:</li>
</ol>
<ul class="md-github">
<li class="md-github">Command: npm install supertest --save-dev</li>
</ul>
<ol start="3" class="md-github">
<li class="md-github">Basic Usage:</li>
</ol>
<ul class="md-github">
<li class="md-github">Require module: const request = require('supertest');</li>
<li class="md-github">Example:
const express = require('express');
const app = express();
app.get('/user', function(req, res) { res.status(200).json({ name: 'john' }); });
request(app).get('/user').expect('Content-Type', /json/).expect('Content-Length', '15').expect(200).end(function(err, res) { if(err) throw err; });</li>
</ul>
<ol start="4" class="md-github">
<li class="md-github">HTTP/2 Configuration:</li>
</ol>
<ul class="md-github">
<li class="md-github">Enable by passing { http2: true } to request or request.agent:
request(app, { http2: true }).get('/user')...</li>
</ul>
<ol start="5" class="md-github">
<li class="md-github">Testing Patterns:</li>
</ol>
<ul class="md-github">
<li class="md-github">Supports callbacks, promises, and async/await.</li>
<li class="md-github">Mocha example with done callback and inline assertion via .expect(200, done).</li>
</ul>
<ol start="6" class="md-github">
<li class="md-github">Authentication &amp; Cookie Handling:</li>
</ol>
<ul class="md-github">
<li class="md-github">Use .auth(username, password) for basic auth.</li>
<li class="md-github">Persist cookies via request.agent: agent(app) with cookie-parser middleware.</li>
</ul>
<ol start="7" class="md-github">
<li class="md-github">API Method Specifications:</li>
</ol>
<ul class="md-github">
<li class="md-github">.expect(status[, fn]) - assert status code.</li>
<li class="md-github">.expect(status, body[, fn]) - assert status and body.</li>
<li class="md-github">.expect(body[, fn]) - assert response body with string, regex or object.</li>
<li class="md-github">.expect(field, value[, fn]) - assert header field.</li>
<li class="md-github">.expect(function(res){}) - custom assertion function; throw error if assertion fails.</li>
<li class="md-github">.end(fn) - execute HTTP request and callback with error and response.</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="supplementary-details" href="#supplementary-details"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Supplementary Details</h2>
<p class="md-github">Installation: npm install supertest --save-dev. Configuration Options:</p>
<ul class="md-github">
<li class="md-github">http2: Boolean option to enable HTTP2 protocol when passed to request or request.agent. Example: { http2: true }.
Testing Details:</li>
<li class="md-github">Basic request example: require('supertest') is used with Express app to perform GET/POST requests.</li>
<li class="md-github">Use .auth(username, password) to pass credentials similar to superagent.</li>
<li class="md-github">Cookie persistence via request.agent with cookie-parser middleware requires setting cookies with res.cookie and retrieving via req.cookies.</li>
</ul>
<p class="md-github">Implementation Steps:</p>
<ol class="md-github">
<li class="md-github">Require and initialize SuperTest and Express.</li>
<li class="md-github">Define routes with desired responses (JSON, headers, etc.).</li>
<li class="md-github">Execute HTTP method call with desired assertions (.expect for headers, status, and custom functions).</li>
<li class="md-github">End tests with .end(callback) managing error propagation.</li>
</ol>
<p class="md-github">Exact Parameter Values:</p>
<ul class="md-github">
<li class="md-github">Header Expectations: e.g., 'Content-Type', /json/; 'Content-Length', '15'.</li>
<li class="md-github">Status Codes: e.g., 200 for success.</li>
</ul>
<p class="md-github">Troubleshooting:</p>
<ul class="md-github">
<li class="md-github">If .end() receives an error, rethrow or call done(err) to fail tests.</li>
<li class="md-github">Check cookie availability when using agent for persistence.</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="reference-details" href="#reference-details"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reference Details</h2>
<p class="md-github">API Specifications:</p>
<ol class="md-github">
<li class="md-github">
<p class="md-github">Function: request(app[, options])</p>
<ul class="md-github">
<li class="md-github">Parameters:
<ul class="md-github">
<li class="md-github">app: HTTP server instance or function</li>
<li class="md-github">options: Object { http2: Boolean } (optional)</li>
</ul>
</li>
<li class="md-github">Returns: SuperTest instance</li>
</ul>
</li>
<li class="md-github">
<p class="md-github">Method: .get(url)</p>
<ul class="md-github">
<li class="md-github">Parameter: url (String)</li>
<li class="md-github">Returns: Test instance</li>
</ul>
</li>
<li class="md-github">
<p class="md-github">Method: .expect(status[, fn])</p>
<ul class="md-github">
<li class="md-github">Parameters:
<ul class="md-github">
<li class="md-github">status: Number (HTTP status code expected)</li>
<li class="md-github">fn: Optional callback function</li>
</ul>
</li>
<li class="md-github">Behavior: Asserts response status code</li>
</ul>
</li>
<li class="md-github">
<p class="md-github">Method: .expect(status, body[, fn])</p>
<ul class="md-github">
<li class="md-github">Parameters:
<ul class="md-github">
<li class="md-github">status: Number</li>
<li class="md-github">body: String, RegExp, or Object to match against response body</li>
<li class="md-github">fn: Optional callback</li>
</ul>
</li>
</ul>
</li>
<li class="md-github">
<p class="md-github">Method: .expect(body[, fn])</p>
<ul class="md-github">
<li class="md-github">Parameter: body (String, RegExp, or Object)</li>
<li class="md-github">Behavior: Asserts response body</li>
</ul>
</li>
<li class="md-github">
<p class="md-github">Method: .expect(field, value[, fn])</p>
<ul class="md-github">
<li class="md-github">Parameters:
<ul class="md-github">
<li class="md-github">field: String (HTTP header field)</li>
<li class="md-github">value: String or RegExp</li>
<li class="md-github">fn: Optional callback</li>
</ul>
</li>
</ul>
</li>
<li class="md-github">
<p class="md-github">Method: .expect(callback)</p>
<ul class="md-github">
<li class="md-github">Parameter: callback function(res) that performs custom assertions. Throw error if condition fails.</li>
</ul>
</li>
<li class="md-github">
<p class="md-github">Method: .end(fn)</p>
<ul class="md-github">
<li class="md-github">Parameter: fn(err, res)</li>
<li class="md-github">Behavior: Finalizes the request, handling errors if any</li>
</ul>
</li>
</ol>
<h2 class="md-github"><a class="md-github__anchor" name="complete-code-example" href="#complete-code-example"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Complete Code Example:</h2>
<p class="md-github">const request = require('supertest');
const express = require('express');
const cookieParser = require('cookie-parser');
const app = express();</p>
<p class="md-github">// Middleware setup
app.use(cookieParser());</p>
<p class="md-github">// Route definition
app.get('/user', function(req, res) {
res.status(200).json({ name: 'john' });
});</p>
<p class="md-github">// Basic test
request(app)
.get('/user')
.expect('Content-Type', /json/)
.expect('Content-Length', '15')
.expect(200)
.end(function(err, res) {
if (err) throw err;
});</p>
<p class="md-github">// HTTP/2 test
request(app, { http2: true })
.get('/user')
.expect(200)
.end(function(err, res) {
if (err) throw err;
});</p>
<p class="md-github">// Mocha test pattern
describe('GET /user', function() {
it('should respond with json', function(done) {
request(app)
.get('/user')
.set('Accept', 'application/json')
.expect('Content-Type', /json/)
.expect(200, done);
});
});</p>
<p class="md-github">// Cookie persistence test
app.get('/', function(req, res) {
res.cookie('cookie', 'hey');
res.send();
});</p>
<p class="md-github">app.get('/return', function(req, res) {
if (req.cookies.cookie) res.send(req.cookies.cookie);
else res.send(':(');
});</p>
<p class="md-github">const agent = request.agent(app);</p>
<p class="md-github">agent
.get('/')
.expect('set-cookie', 'cookie=hey; Path=/', function(err) {
if (err) throw err;
});</p>
<h2 class="md-github"><a class="md-github__anchor" name="agentgetreturnexpecthey-functionerr-if-err-throw-err" href="#agentgetreturnexpecthey-functionerr-if-err-throw-err"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>agent
.get('/return')
.expect('hey', function(err) {
if (err) throw err;
});</h2>
<p class="md-github">Configuration Options:</p>
<ul class="md-github">
<li class="md-github">{ http2: true } enables HTTP/2 support.</li>
</ul>
<p class="md-github">Best Practices:</p>
<ul class="md-github">
<li class="md-github">Chain assertions in the order of expected response alterations.</li>
<li class="md-github">Utilize custom assertion functions for advanced validations.</li>
<li class="md-github">Ensure error handling in the .end() callback to properly fail test cases.</li>
</ul>
<p class="md-github">Troubleshooting Procedures:</p>
<ul class="md-github">
<li class="md-github">Run individual tests with verbose logging using console.log(err) in .end() to track assertion failures.</li>
<li class="md-github">Verify that the Express app is correctly configured to handle cookies when using agent.</li>
<li class="md-github">Ensure that HTTP header expectations match the exact output from the server.</li>
</ul>
<p class="md-github">Return Types: All callback functions follow Node.js error-first callback conventions.</p>
<h2 class="md-github"><a class="md-github__anchor" name="information-dense-extract" href="#information-dense-extract"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Information Dense Extract</h2>
<p class="md-github">Library: SuperTest; Installation: npm install supertest --save-dev; Usage: require('supertest'), bind to Express app; HTTP/2: enable via { http2: true }; API: .get(url), .expect(status[, fn]), .expect(status, body[, fn]), .expect(body[, fn]), .expect(field, value[, fn]), .expect(function(res){}) and .end(fn); Patterns: supports callbacks, Promises, async/await; Authentication: .auth(username, password); Cookie Handling: request.agent with cookie-parser; Complete API details provided with parameters, return types, and error handling; Best practices include chaining assertions and robust error propagation.</p>
<h2 class="md-github"><a class="md-github__anchor" name="sanitised-extract" href="#sanitised-extract"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Sanitised Extract</h2>
<p class="md-github">Table of Contents:</p>
<ol class="md-github">
<li class="md-github">
<p class="md-github">Introduction</p>
</li>
<li class="md-github">
<p class="md-github">Installation</p>
</li>
<li class="md-github">
<p class="md-github">Basic Usage</p>
</li>
<li class="md-github">
<p class="md-github">HTTP/2 Configuration</p>
</li>
<li class="md-github">
<p class="md-github">Testing Patterns</p>
</li>
<li class="md-github">
<p class="md-github">Authentication &amp; Cookie Handling</p>
</li>
<li class="md-github">
<p class="md-github">API Method Specifications</p>
</li>
<li class="md-github">
<p class="md-github">Introduction:</p>
</li>
</ol>
<ul class="md-github">
<li class="md-github">Library: SuperTest for testing HTTP servers using superagent.</li>
<li class="md-github">Supports ephemeral port binding if server not listening.</li>
</ul>
<ol start="2" class="md-github">
<li class="md-github">Installation:</li>
</ol>
<ul class="md-github">
<li class="md-github">Command: npm install supertest --save-dev</li>
</ul>
<ol start="3" class="md-github">
<li class="md-github">Basic Usage:</li>
</ol>
<ul class="md-github">
<li class="md-github">Require module: const request = require('supertest');</li>
<li class="md-github">Example:
const express = require('express');
const app = express();
app.get('/user', function(req, res) { res.status(200).json({ name: 'john' }); });
request(app).get('/user').expect('Content-Type', /json/).expect('Content-Length', '15').expect(200).end(function(err, res) { if(err) throw err; });</li>
</ul>
<ol start="4" class="md-github">
<li class="md-github">HTTP/2 Configuration:</li>
</ol>
<ul class="md-github">
<li class="md-github">Enable by passing { http2: true } to request or request.agent:
request(app, { http2: true }).get('/user')...</li>
</ul>
<ol start="5" class="md-github">
<li class="md-github">Testing Patterns:</li>
</ol>
<ul class="md-github">
<li class="md-github">Supports callbacks, promises, and async/await.</li>
<li class="md-github">Mocha example with done callback and inline assertion via .expect(200, done).</li>
</ul>
<ol start="6" class="md-github">
<li class="md-github">Authentication &amp; Cookie Handling:</li>
</ol>
<ul class="md-github">
<li class="md-github">Use .auth(username, password) for basic auth.</li>
<li class="md-github">Persist cookies via request.agent: agent(app) with cookie-parser middleware.</li>
</ul>
<ol start="7" class="md-github">
<li class="md-github">API Method Specifications:</li>
</ol>
<ul class="md-github">
<li class="md-github">.expect(status[, fn]) - assert status code.</li>
<li class="md-github">.expect(status, body[, fn]) - assert status and body.</li>
<li class="md-github">.expect(body[, fn]) - assert response body with string, regex or object.</li>
<li class="md-github">.expect(field, value[, fn]) - assert header field.</li>
<li class="md-github">.expect(function(res){}) - custom assertion function; throw error if assertion fails.</li>
<li class="md-github">.end(fn) - execute HTTP request and callback with error and response.</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="original-source" href="#original-source"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Original Source</h2>
<p class="md-github">Supertest Documentation
https://github.com/visionmedia/supertest</p>
<h2 class="md-github"><a class="md-github__anchor" name="digest-of-supertest" href="#digest-of-supertest"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Digest of SUPERTEST</h2>
<h1 class="md-github"><a class="md-github__anchor" name="supertest-documentation" href="#supertest-documentation"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SuperTest Documentation</h1>
<p class="md-github">Retrieved Date: 2023-10-30
Data Size: 661880 bytes</p>
<h1 class="md-github"><a class="md-github__anchor" name="overview" href="#overview"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overview</h1>
<p class="md-github">SuperTest offers a high-level abstraction for HTTP testing built on top of superagent. It supports basic HTTP requests, HTTP/2 configuration, cookie handling, and multiple testing paradigms (callbacks, promises, async/await).</p>
<h1 class="md-github"><a class="md-github__anchor" name="installation" href="#installation"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h1>
<p class="md-github">To install, add supertest as a development dependency:</p>
<p class="md-github">npm install supertest --save-dev</p>
<h1 class="md-github"><a class="md-github__anchor" name="basic-usage" href="#basic-usage"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Usage</h1>
<p class="md-github">Include the module by requiring it:</p>
<p class="md-github">const request = require('supertest');
const express = require('express');
const app = express();</p>
<p class="md-github">app.get('/user', function(req, res) {
res.status(200).json({ name: 'john' });
});</p>
<p class="md-github">request(app)
.get('/user')
.expect('Content-Type', /json/)
.expect('Content-Length', '15')
.expect(200)
.end(function(err, res) {
if (err) throw err;
});</p>
<h1 class="md-github"><a class="md-github__anchor" name="http2-support" href="#http2-support"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>HTTP2 Support</h1>
<p class="md-github">To enable HTTP2, pass an options object with { http2: true } to request or request.agent:</p>
<p class="md-github">const request = require('supertest');</p>
<p class="md-github">request(app, { http2: true })
.get('/user')
.expect('Content-Type', /json/)
.expect('Content-Length', '15')
.expect(200)
.end(function(err, res) {
if (err) throw err;
});</p>
<p class="md-github">request.agent(app, { http2: true })
.get('/user')
.expect('Content-Type', /json/)
.expect('Content-Length', '15')
.expect(200)
.end(function(err, res) {
if (err) throw err;
});</p>
<h1 class="md-github"><a class="md-github__anchor" name="mocha-integration--asynchronous-patterns" href="#mocha-integration--asynchronous-patterns"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mocha Integration &amp; Asynchronous Patterns</h1>
<p class="md-github">Examples for Mocha with callback, promise and async/await patterns:</p>
<p class="md-github">// Using callbacks:
describe('GET /user', function() {
it('responds with json', function(done) {
request(app)
.get('/user')
.set('Accept', 'application/json')
.expect('Content-Type', /json/)
.expect(200, done);
});
});</p>
<p class="md-github">// Using promises:
describe('GET /users', function() {
it('responds with json', function() {
return request(app)
.get('/users')
.set('Accept', 'application/json')
.expect('Content-Type', /json/)
.expect(200)
.then(response =&gt; {
// Assertion: response.body.email equals expected email
});
});
});</p>
<p class="md-github">// Using async/await:
describe('GET /users', function() {
it('responds with json', async function() {
const response = await request(app)
.get('/users')
.set('Accept', 'application/json');
// Assertions
});
});</p>
<h1 class="md-github"><a class="md-github__anchor" name="authentication" href="#authentication"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Authentication</h1>
<p class="md-github">Pass HTTP credentials using the auth method as in superagent:</p>
<p class="md-github">describe('GET /user', function() {
it('responds with json', function(done) {
request(app)
.get('/user')
.auth('username', 'password')
.set('Accept', 'application/json')
.expect('Content-Type', /json/)
.expect(200, done);
});
});</p>
<h1 class="md-github"><a class="md-github__anchor" name="cookie-handling" href="#cookie-handling"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cookie Handling</h1>
<p class="md-github">Persist cookies using request.agent:</p>
<p class="md-github">const cookieParser = require('cookie-parser');
const express = require('express');
const app = express();
app.use(cookieParser());</p>
<p class="md-github">app.get('/', function(req, res) {
res.cookie('cookie', 'hey');
res.send();
});</p>
<p class="md-github">app.get('/return', function(req, res) {
if (req.cookies.cookie) res.send(req.cookies.cookie);
else res.send(':(');
});</p>
<p class="md-github">const agent = request.agent(app);</p>
<p class="md-github">// Save cookies:
agent
.get('/')
.expect('set-cookie', 'cookie=hey; Path=/', function(err) {
if (err) throw err;
});</p>
<p class="md-github">// Use cookies:
agent
.get('/return')
.expect('hey', function(err) {
if (err) throw err;
});</p>
<h1 class="md-github"><a class="md-github__anchor" name="api-details" href="#api-details"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>API Details</h1>
<p class="md-github">SuperTest supports all superagent methods. Key API methods include:</p>
<p class="md-github">.expect(status[, fn])
.expect(status, body[, fn])
.expect(body[, fn])
.expect(field, value[, fn])
.expect(function(res) {})
.end(fn)</p>
<p class="md-github">Custom assertion example:</p>
<p class="md-github">function hasPreviousAndNextKeys(res) {
if (!('next' in res.body)) throw new Error('missing next key');
if (!('prev' in res.body)) throw new Error('missing prev key');
}</p>
<p class="md-github">request(app)
.get('/')
.expect(hasPreviousAndNextKeys)
.end(function(err, res) {
if (err) throw err;
});</p>
<h1 class="md-github"><a class="md-github__anchor" name="troubleshooting" href="#troubleshooting"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Troubleshooting</h1>
<p class="md-github">If .expect() fails in .end(), the error is provided as the first argument. To fail the test case, rethrow the error or pass it to the done callback:</p>
<p class="md-github">if (err) return done(err);
return done();</p>
<p class="md-github">Attribution: Crawled from https://github.com/visionmedia/supertest
License: MIT</p>
<h2 class="md-github"><a class="md-github__anchor" name="attribution" href="#attribution"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Attribution</h2>
<ul class="md-github">
<li class="md-github">Source: Supertest Documentation</li>
<li class="md-github">URL: https://github.com/visionmedia/supertest</li>
<li class="md-github">License: MIT License</li>
<li class="md-github">Crawl Date: 2025-04-28T16:51:30.456Z</li>
<li class="md-github">Data Size: 661880 bytes</li>
<li class="md-github">Links Found: 5442</li>
</ul>
<h2 class="md-github"><a class="md-github__anchor" name="retrieved" href="#retrieved"><svg class="md-github__octicon md-github__octicon-link" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Retrieved</h2>
<p class="md-github">2025-04-28</p>

  </section>
  <footer>
    <p>Generated on 2025-05-01T06:24:56.492Z</p>
  </footer>
</body>
</html>